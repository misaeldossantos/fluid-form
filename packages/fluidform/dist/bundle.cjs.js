"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./node_modules/mobx-react-lite/es/index.js"),t=require("../../node_modules/react/index.js"),r=require("lodash"),a=require("./node_modules/mobx-react/dist/mobxreact.esm.js"),s=require("./node_modules/mobx/dist/mobx.esm.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(t),l=t.createContext(null);var u=e.observer((function({children:e,validateOnBlur:r,form:a}){if(!a)return e;const{errors:s,values:o}=a,u=t.useCallback((e=>{r&&a.validatePath(e)}),[r]);return n.default.createElement(l.Provider,{value:{values:o,onBlur:u,errors:s,form:a}},e)})),i=t.createContext({components:{form:{}}});function c(...e){return function(...t){for(let r of e)r&&r(...t)}}const d={asChange:{alias:"onChange",apply:e=>e},asValue:"value",asOnBlur:{alias:"onBlur"}};var v=a.observer((({path:e,use:a,children:o,onChange:u,displayValue:v,defaultValue:h,...f})=>{const{values:m,errors:p,onBlur:g}=t.useContext(l),x=function(e){const r=t.useContext(i);return t.useMemo((()=>r.components[e]),[e,r])}("form"),{...b}=n.default.useMemo((()=>x[a]||f),[x,a]),{asValue:y=d.asValue,asChange:C=[],asOnBlur:V=d.asOnBlur.alias}=b,[P=d.asChange.alias]=C,B=n.default.useMemo((()=>C[1]?"function"==typeof C[1]?C[1]:"string"==typeof C[1]?e=>r.get(e,C[1]):void 0:d.asChange.apply),[C]);function E(){const t=r.get(m,e);return v?v(t):t}const j=n.default.useCallback((()=>E()||h||function(e=String){switch(e){case String:return"";case Number:return 0;case Boolean:return!1}}(b.type)),[b.type]),[O,_]=t.useState(j);t.useEffect((()=>s.reaction((()=>r.get(m,e)),(()=>{_(E())}))),[]);const q={[y]:O,[P]:c(((...t)=>r.set(m,e,B(...t))),u),[V]:()=>g(e),error:r.get(p,e)},w=n.default.Children.only(o);return n.default.cloneElement(w,{key:e,...q},w.props.children)}));class h{constructor({initialValues:e,validator:t}){this.errors={},this.values={},this.values=e||{},this.validator=t,s.makeAutoObservable(this)}async validateAll(){s.set(this.errors,await this.validator(this.values))}get isValid(){if(!this.validator)return!1;const e=this.validator(this.values);return r.isEmpty(e)}async validatePath(e){this.setPathError(e,await this.validator(this.values,e))}setPathError(e,t){r.set(this.errors,e,t)}setValues(e){this.values=r.merge(s.toJS(this.values),e)}setPathValue(e,t){s.set(this.values,e,t)}get raw(){return s.toJS(this.values)}}exports.Field=v,exports.Form=u,exports.FormProvider=({components:e,children:t})=>n.default.createElement(i.Provider,{value:{components:e}},t),exports.useForm=function({initialValues:e,validator:r}={}){return t.useMemo((()=>new h({initialValues:e,validator:r})),[r])};
